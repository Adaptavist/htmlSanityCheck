[[template-method]]
=== Flexible Checking Algorithms
kbd:[HtmlSC] uses the {template-method-pattern} to enable flexible checking algorithms:

[quote, http://sourcemaking.com/design_patterns/template_method]
The Template Method defines a skeleton of an algorithm in an operation, and defers some steps to subclasses.

We achieve that by defining the skeleton of the checking algorithm in one operation, deferring the specific checking algorithm steps to subclasses.

The invariant steps are implemented in the abstract base class, while the variant checking algorithms have to be provided by the subclasses.

[source, groovy]
    /**
    ** template method for performing a single type of checks
     * on the given @see HtmlPage.
     *
     * Prerequisite: pageToCheck has been successfully parsed,
     * prior to constructing this Checker instance.
    **/
    public CheckingResultsCollector performCheck() {
        // assert prerequisite
        assert pageToCheck != null
        initResults()
        return check() // execute the actual checking algorithm
    }



image::template-method.png["Template Method", title="Template-Method Overview"]

[options="header", cols="1,4"]
.Template Method
|===
| Component | Description
| Checker    | _abstract_ base class, containing the template method plus an abstract method +check()+
| <<ImageFileExistChecker>> | checks if referenced images exist, relative to +baseDirectory+
| InternalLinksChecker | checks if links referenced within the page exist
| DuplicateIdChecker   | checks if any id has multiple definitions
|===


==== ImageFileExistChecker
The (little) problem with checking images is their path: Consider the following
HTML fragment (from the file +testme.html+:


[source, html]
<img src="./images/one-image.jpg">


This image file ("one-image.jpg") has to be located relative to the directory containing the corresponding HTML file, i.e.:

   /Users/gstarke/projects/htmlSanityChecker/test/testme.html

Therefore the expected local absolute path of the "one-image.jpg" would be:

  /Users/gstarke/projects/htmlSanityChecker/test/images/one-image.jpg


We check for existing files using the usual Java api, but have to add the
+baseDir+ (directory prefix) to the image-src given in the HTML tag to get the +absolutePathToImageFile+:


[source, java]
  File f = new File( absolutePathToImageFile );
  if(f.exists() && !f.isDirectory())
